<?php/* * **************************************** *     _____                     *    |  __ \                    *    | |  | |_   _  ___  _ __   *    | |  | | | | |/ _ \| '_ \  *    | |__| | |_| | (_) | | | | *    |_____/ \__, |\___/|_| |_| *             __/ |             *            |___/   *            *       Paulo Felipe Possa Parrira [ paul (dot) 0 (at) live (dot) de ] *  ===================================================================== *  File: users_public.php *  Type: Controller *  ===================================================================== *  */require_once("includes/control/usuario/users.php");class authController {    public function __construct() {        $this->conn = new conn();        $this->usercontroller = new userController();    }    /**     * Inicializa a classe de controle, quando chamada pela interface via browser.     * @param Array $url     */    public function init($url) {        try {            $this->user = $this->usercontroller->getUser();            header("location: " . HTTP_ROOT);        } catch (Exception $ex) {            switch ($url[0]) {                case "login":                    $this->loadLogin();                    break;                case "signup":                    $this->loadSignup();                    break;            }        }    }    private function loadLogin() {        if (isset($_POST["login"])) {            $login = filter_input(INPUT_POST, "login", FILTER_SANITIZE_FULL_SPECIAL_CHARS, FILTER_REQUIRE_ARRAY);            $this->usercontroller->loginUser($login['email'], $login['senha']);            header("location: " . HTTP_ROOT);        }        Twig_Autoloader::register();        $this->twig_loader = new Twig_Loader_Filesystem('includes/interface/templates/public');        $this->twig = new Twig_Environment($this->twig_loader);        echo $this->twig->render("auth/login.twig", array("config" => config::$html_preload));    }    private function loadSignup() {        if (isset($_POST["submit"])) {            try {                $this->usercontroller->addUser();                header("location: " . HTTP_ROOT);            } catch (Exception $ex) {                $error = $ex->getMessage();            }        }        Twig_Autoloader::register();        $this->twig_loader = new Twig_Loader_Filesystem('includes/interface/templates/public');        $this->twig = new Twig_Environment($this->twig_loader);        echo $this->twig->render("auth/signup.twig", array("error" => $error, "config" => config::$html_preload));    }}function init_module_auth($url) {    $authcontroller = new authController();    $authcontroller->init($url);}?>